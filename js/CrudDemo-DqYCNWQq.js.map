{"version":3,"file":"CrudDemo-DqYCNWQq.js","sources":["../../src/views/pages/CrudDemo.vue"],"sourcesContent":["<template>\n  <div class=\"grid crud-demo\">\n    <div class=\"col-12\">\n      <div class=\"card\">\n        <Toast />\n        <Toolbar class=\"mb-4\">\n          <template #start>\n            <Button\n              label=\"新建\"\n              icon=\"pi pi-plus\"\n              class=\"p-button-success mr-2\"\n              @click=\"openNew\"\n            />\n            <Button\n              label=\"删除\"\n              icon=\"pi pi-trash\"\n              class=\"p-button-danger\"\n              :disabled=\"!selectedProducts || !selectedProducts.length\"\n              @click=\"confirmDeleteSelected\"\n            />\n          </template>\n\n          <template #end>\n            <FileUpload\n              mode=\"basic\"\n              accept=\"image/*\"\n              :max-file-size=\"1000000\"\n              choose-label=\"导入\"\n              class=\"mr-2 p-d-inline-block\"\n            />\n            <Button\n              label=\"导出\"\n              icon=\"pi pi-upload\"\n              class=\"p-button-help\"\n              @click=\"exportCSV($event)\"\n            />\n          </template>\n        </Toolbar>\n\n        <DataTable\n          ref=\"dt\"\n          :selection.sync=\"selectedProducts\"\n          :value=\"products\"\n          data-key=\"id\"\n          :row-hover=\"true\"\n          :paginator=\"true\"\n          :rows=\"10\"\n          :filters=\"filters\"\n          paginator-template=\" FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink    RowsPerPageDropdown  CurrentPageReport\"\n          :rows-per-page-options=\"[5, 10, 25]\"\n          current-page-report-template=\" 显示第 {first} 到第 {last} 条记录，总共 {totalRecords} 条记录 \"\n          class=\"p-datatable-customers\"\n        >\n          <template #header>\n            <div class=\"table-header\">\n              <h5 class=\"p-m-0\">\n                产品列表\n              </h5>\n              <span class=\"p-input-icon-left\">\n                <i class=\"pi pi-search\" />\n                <InputText\n                  v-model=\"filters['global']\"\n                  placeholder=\"检索...\"\n                />\n              </span>\n            </div>\n          </template>\n\n          <Column\n            selection-mode=\"multiple\"\n            header-style=\"width: 3rem\"\n          />\n          <Column\n            field=\"code\"\n            header=\"编码\"\n            sortable\n          />\n          <Column\n            field=\"name\"\n            header=\"名称\"\n            sortable\n          />\n          <Column header=\"图片\">\n            <template #body=\"slotProps\">\n              <img\n                :src=\"$publicUrl('resource/demo/images/product/' + slotProps.data.image)\"\n                :alt=\"slotProps.data.image\"\n                class=\"product-image\"\n              >\n            </template>\n          </Column>\n          <Column\n            field=\"price\"\n            header=\"价格\"\n            sortable\n          >\n            <template #body=\"slotProps\">\n              {{ formatCurrency(slotProps.data.price) }}\n            </template>\n          </Column>\n          <Column\n            field=\"category\"\n            header=\"类别\"\n            sortable\n          />\n          <Column\n            field=\"rating\"\n            header=\"评分\"\n            sortable\n          >\n            <template #body=\"slotProps\">\n              <Rating\n                :value=\"slotProps.data.rating\"\n                :readonly=\"true\"\n                :cancel=\"false\"\n              />\n            </template>\n          </Column>\n          <Column\n            field=\"inventoryStatus\"\n            header=\"状态\"\n            sortable\n          >\n            <template #body=\"slotProps\">\n              <span\n                :class=\"\n                  'product-badge status-' +\n                    slotProps.data.inventoryStatus.toLowerCase()\n                \"\n              >{{ slotProps.data.inventoryStatus }}</span>\n            </template>\n          </Column>\n          <Column>\n            <template #body=\"slotProps\">\n              <Button\n                icon=\"pi pi-pencil\"\n                class=\"p-button-rounded p-button-success mr-2\"\n                @click=\"editProduct(slotProps.data)\"\n              />\n              <Button\n                icon=\"pi pi-trash\"\n                class=\"p-button-rounded p-button-warning\"\n                @click=\"confirmDeleteProduct(slotProps.data)\"\n              />\n            </template>\n          </Column>\n        </DataTable>\n\n        <Dialog\n          visible.sync=\"productDialog\"\n          :style=\"{ width: '450px' }\"\n          header=\"产品详情\"\n          :modal=\"true\"\n          class=\"p-fluid\"\n        >\n          <img\n            v-if=\"product.image\"\n            :src=\"$publicUrl('resource/demo/images/product/' + product.image)\"\n            :alt=\"product.image\"\n            class=\"product-image\"\n          >\n          <div class=\"field\">\n            <label for=\"name\">名称</label>\n            <InputText\n              id=\"name\"\n              v-model.trim=\"product.name\"\n              required=\"true\"\n              autofocus\n              :class=\"{ 'p-invalid': submitted && !product.name }\"\n            />\n            <small\n              v-if=\"submitted && !product.name\"\n              class=\"p-invalid\"\n            >名称是必须的。</small>\n          </div>\n          <div class=\"field\">\n            <label for=\"description\">描述</label>\n            <Textarea\n              id=\"description\"\n              v-model=\"product.description\"\n              required=\"true\"\n              rows=\"3\"\n              cols=\"20\"\n            />\n          </div>\n\n          <div class=\"field\">\n            <label class=\"mb-3\">分类</label>\n            <div class=\"formgrid grid\">\n              <div class=\"field-radiobutton col-6\">\n                <RadioButton\n                  id=\"category1\"\n                  v-model=\"product.category\"\n                  name=\"category\"\n                />\n                <label for=\"category1\">穿戴配饰</label>\n              </div>\n              <div class=\"field-radiobutton col-6\">\n                <RadioButton\n                  id=\"category2\"\n                  v-model=\"product.category\"\n                  name=\"category\"\n                />\n                <label for=\"category2\">服装</label>\n              </div>\n              <div class=\"field-radiobutton col-6\">\n                <RadioButton\n                  id=\"category3\"\n                  v-model=\"product.category\"\n                  name=\"category\"\n                />\n                <label for=\"category3\">电子产品</label>\n              </div>\n              <div class=\"field-radiobutton col-6\">\n                <RadioButton\n                  id=\"category4\"\n                  v-model=\"product.category\"\n                  name=\"category\"\n                />\n                <label for=\"category4\">小饰品</label>\n              </div>\n            </div>\n          </div>\n\n          <div class=\"formgrid grid\">\n            <div class=\"field col\">\n              <label for=\"price\">价格</label>\n              <InputNumber\n                id=\"price\"\n                v-model=\"product.price\"\n                mode=\"currency\"\n                currency=\"USD\"\n                locale=\"en-US\"\n              />\n            </div>\n            <div class=\"field col\">\n              <label for=\"quantity\">数量</label>\n              <InputNumber\n                id=\"quantity\"\n                v-model=\"product.quantity\"\n                integeronly\n              />\n            </div>\n          </div>\n          <template #footer>\n            <Button\n              label=\"取消\"\n              icon=\"pi pi-times\"\n              class=\"p-button-text\"\n              @click=\"hideDialog\"\n            />\n            <Button\n              label=\"保存\"\n              icon=\"pi pi-check\"\n              class=\"p-button-text\"\n              @click=\"saveProduct\"\n            />\n          </template>\n        </Dialog>\n\n        <Dialog\n          :visible.sync=\"deleteProductDialog\"\n          :style=\"{ width: '450px' }\"\n          header=\"确认\"\n          :modal=\"true\"\n        >\n          <div class=\"confirmation-content\">\n            <i\n              class=\"pi pi-exclamation-triangle mr-3\"\n              style=\"font-size: 2rem\"\n            />\n            <span v-if=\"product\">确认删除 <b>{{ product.name }}</b>?</span>\n          </div>\n          <template #footer>\n            <Button\n              label=\"否\"\n              icon=\"pi pi-times\"\n              class=\"p-button-text\"\n              @click=\"deleteProductDialog = false\"\n            />\n            <Button\n              label=\"是\"\n              icon=\"pi pi-check\"\n              class=\"p-button-text\"\n              @click=\"deleteProduct\"\n            />\n          </template>\n        </Dialog>\n\n        <Dialog\n          :visible.sync=\"deleteProductsDialog\"\n          :style=\"{ width: '450px' }\"\n          header=\"确认\"\n          :modal=\"true\"\n        >\n          <div class=\"confirmation-content\">\n            <i\n              class=\"pi pi-exclamation-triangle mr-3\"\n              style=\"font-size: 2rem\"\n            />\n            <span v-if=\"product\">确认删除所选项吗?</span>\n          </div>\n          <template #footer>\n            <Button\n              label=\"否\"\n              icon=\"pi pi-times\"\n              class=\"p-button-text\"\n              @click=\"deleteProductsDialog = false\"\n            />\n            <Button\n              label=\"是\"\n              icon=\"pi pi-check\"\n              class=\"p-button-text\"\n              @click=\"deleteSelectedProducts\"\n            />\n          </template>\n        </Dialog>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ProductService from '@/api/ProductService'\n\nexport default {\n  data() {\n    return {\n      products: null,\n      productDialog: false,\n      deleteProductDialog: false,\n      deleteProductsDialog: false,\n      product: {},\n      selectedProducts: null,\n      filters: {},\n      submitted: false\n    }\n  },\n  productService: null,\n  created() {\n    this.productService = new ProductService()\n  },\n  mounted() {\n    this.productService.getProducts().then((data) => (this.products = data))\n  },\n  methods: {\n    formatCurrency(value) {\n      return value.toLocaleString('en-US', {\n        style: 'currency',\n        currency: 'USD'\n      })\n    },\n    openNew() {\n      this.product = {}\n      this.submitted = false\n      this.productDialog = true\n    },\n    hideDialog() {\n      this.productDialog = false\n      this.submitted = false\n    },\n    saveProduct() {\n      this.submitted = true\n\n      if (this.product.name.trim()) {\n        if (this.product.id) {\n          this.$set(\n            this.products,\n            this.findIndexById(this.product.id),\n            this.product\n          )\n          this.$toast.add({\n            severity: 'success',\n            summary: '提示',\n            detail: '更新成功',\n            life: 3000\n          })\n        } else {\n          this.product.id = this.createId()\n          this.product.code = this.createId()\n          this.product.image = 'product-placeholder.svg'\n          this.product.inventoryStatus = 'INSTOCK'\n          this.products.push(this.product)\n          this.$toast.add({\n            severity: 'success',\n            summary: '提示',\n            detail: '新建成功',\n            life: 3000\n          })\n        }\n\n        this.productDialog = false\n        this.product = {}\n      }\n    },\n    editProduct(product) {\n      this.product = { ...product }\n      this.productDialog = true\n    },\n    confirmDeleteProduct(product) {\n      this.product = product\n      this.deleteProductDialog = true\n    },\n    deleteProduct() {\n      this.products = this.products.filter((val) => val.id !== this.product.id)\n      this.deleteProductDialog = false\n      this.product = {}\n      this.$toast.add({\n        severity: 'success',\n        summary: '提示',\n        detail: '删除成功',\n        life: 3000\n      })\n    },\n    findIndexById(id) {\n      let index = -1\n      for (let i = 0; i < this.products.length; i++) {\n        if (this.products[i].id === id) {\n          index = i\n          break\n        }\n      }\n\n      return index\n    },\n    createId() {\n      let id = ''\n      var chars =\n        'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'\n      for (var i = 0; i < 5; i++) {\n        id += chars.charAt(Math.floor(Math.random() * chars.length))\n      }\n      return id\n    },\n    exportCSV() {\n      this.$refs.dt.exportCSV()\n    },\n    confirmDeleteSelected() {\n      this.deleteProductsDialog = true\n    },\n    deleteSelectedProducts() {\n      this.products = this.products.filter(\n        (val) => !this.selectedProducts.includes(val)\n      )\n      this.deleteProductsDialog = false\n      this.selectedProducts = null\n      this.$toast.add({\n        severity: 'success',\n        summary: '提示',\n        detail: '删除成功',\n        life: 3000\n      })\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n.table-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.product-image {\n  width: 100px;\n  box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23);\n}\n\n.p-dialog .product-image {\n  width: 150px;\n  margin: 0 auto 2rem auto;\n  display: block;\n}\n\n.confirmation-content {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.product-badge {\n  border-radius: 2px;\n  padding: 0.25em 0.5rem;\n  text-transform: uppercase;\n  font-weight: 700;\n  font-size: 12px;\n  letter-spacing: 0.3px;\n\n  &.status-有现货 {\n    background: #c8e6c9;\n    color: #256029;\n  }\n\n  &.status-缺货 {\n    background: #ffcdd2;\n    color: #c63737;\n  }\n\n  &.status-lowstock {\n    background: #feedaf;\n    color: #8a5340;\n  }\n}\n\n@media screen and (max-width: 960px) {\n  ::v-deep .p-datatable {\n    &.p-datatable-customers {\n      .p-datatable-thead > tr > th,\n      .p-datatable-tfoot > tr > td {\n        display: none !important;\n      }\n\n      .p-datatable-tbody > tr {\n        border-bottom: 1px solid var(--surface-d);\n\n        > td {\n          text-align: left;\n          display: block;\n          border: 0 none !important;\n          width: 100% !important;\n          float: left;\n          clear: left;\n          border: 0 none;\n\n          .p-column-title {\n            padding: 0.4rem;\n            min-width: 30%;\n            display: inline-block;\n            margin: -0.4rem 1rem -0.4rem -0.4rem;\n            font-weight: bold;\n          }\n\n          .p-progressbar {\n            margin-top: 0.5rem;\n          }\n        }\n      }\n    }\n  }\n\n  ::v-deep .p-toolbar {\n    flex-wrap: wrap;\n\n    .p-button {\n      margin-bottom: 0.25rem;\n    }\n  }\n}\n</style>\n"],"names":["_sfc_main","ProductService","data","value","product","val","id","index","i","chars"],"mappings":"+XAqUA,MAAAA,EAAA,CACA,MAAA,CACA,MAAA,CACA,SAAA,KACA,cAAA,GACA,oBAAA,GACA,qBAAA,GACA,QAAA,CAAA,EACA,iBAAA,KACA,QAAA,CAAA,EACA,UAAA,EACA,CACA,EACA,eAAA,KACA,SAAA,CACA,KAAA,eAAA,IAAAC,CACA,EACA,SAAA,CACA,KAAA,eAAA,YAAA,EAAA,KAAAC,GAAA,KAAA,SAAAA,CAAA,CACA,EACA,QAAA,CACA,eAAAC,EAAA,CACA,OAAAA,EAAA,eAAA,QAAA,CACA,MAAA,WACA,SAAA,KACA,CAAA,CACA,EACA,SAAA,CACA,KAAA,QAAA,CAAA,EACA,KAAA,UAAA,GACA,KAAA,cAAA,EACA,EACA,YAAA,CACA,KAAA,cAAA,GACA,KAAA,UAAA,EACA,EACA,aAAA,CACA,KAAA,UAAA,GAEA,KAAA,QAAA,KAAA,KAAA,IACA,KAAA,QAAA,IACA,KAAA,KACA,KAAA,SACA,KAAA,cAAA,KAAA,QAAA,EAAA,EACA,KAAA,OACA,EACA,KAAA,OAAA,IAAA,CACA,SAAA,UACA,QAAA,KACA,OAAA,OACA,KAAA,GACA,CAAA,IAEA,KAAA,QAAA,GAAA,KAAA,SAAA,EACA,KAAA,QAAA,KAAA,KAAA,SAAA,EACA,KAAA,QAAA,MAAA,0BACA,KAAA,QAAA,gBAAA,UACA,KAAA,SAAA,KAAA,KAAA,OAAA,EACA,KAAA,OAAA,IAAA,CACA,SAAA,UACA,QAAA,KACA,OAAA,OACA,KAAA,GACA,CAAA,GAGA,KAAA,cAAA,GACA,KAAA,QAAA,CAAA,EAEA,EACA,YAAAC,EAAA,CACA,KAAA,QAAA,CAAA,GAAAA,CAAA,EACA,KAAA,cAAA,EACA,EACA,qBAAAA,EAAA,CACA,KAAA,QAAAA,EACA,KAAA,oBAAA,EACA,EACA,eAAA,CACA,KAAA,SAAA,KAAA,SAAA,OAAAC,GAAAA,EAAA,KAAA,KAAA,QAAA,EAAA,EACA,KAAA,oBAAA,GACA,KAAA,QAAA,CAAA,EACA,KAAA,OAAA,IAAA,CACA,SAAA,UACA,QAAA,KACA,OAAA,OACA,KAAA,GACA,CAAA,CACA,EACA,cAAAC,EAAA,CACA,IAAAC,EAAA,GACA,QAAAC,EAAA,EAAAA,EAAA,KAAA,SAAA,OAAAA,IACA,GAAA,KAAA,SAAAA,CAAA,EAAA,KAAAF,EAAA,CACAC,EAAAC,EACA,KACA,CAGA,OAAAD,CACA,EACA,UAAA,CACA,IAAAD,EAAA,GAGA,QAFAG,EACA,iEACAD,EAAA,EAAAA,EAAA,EAAAA,IACAF,GAAAG,EAAA,OAAA,KAAA,MAAA,KAAA,OAAA,EAAAA,EAAA,MAAA,CAAA,EAEA,OAAAH,CACA,EACA,WAAA,CACA,KAAA,MAAA,GAAA,UAAA,CACA,EACA,uBAAA,CACA,KAAA,qBAAA,EACA,EACA,wBAAA,CACA,KAAA,SAAA,KAAA,SAAA,OACAD,GAAA,CAAA,KAAA,iBAAA,SAAAA,CAAA,CACA,EACA,KAAA,qBAAA,GACA,KAAA,iBAAA,KACA,KAAA,OAAA,IAAA,CACA,SAAA,UACA,QAAA,KACA,OAAA,OACA,KAAA,GACA,CAAA,CACA,CACA,CACA"}